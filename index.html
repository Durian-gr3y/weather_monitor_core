<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nigeria Weather Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f2f5;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    #generated {
      text-align: center;
      margin-bottom: 20px;
      color: #555;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
    }

    .card {
      background: white;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    .risk-low { border-left: 5px solid green; }
    .risk-moderate { border-left: 5px solid orange; }
    .risk-high { border-left: 5px solid red; }

    .card h3 { margin-top: 0; }
    .card p { margin: 5px 0; }
  </style>
</head>
<body>
  <h1>Nigeria Weather Dashboard</h1>
  <div id="generated"></div>
  <div class="grid" id="weather-grid"></div>

  <script>
    async function loadWeather() {
      try {
        const res = await fetch("weather_data.json");
        const data = await res.json();

        // Display last update
        const generatedDiv = document.getElementById("generated");
        generatedDiv.textContent = "Last updated: " + data.generated_at;

        // Sort by rain_probability descending
        data.locations.sort((a,b) => b.rain_probability - a.rain_probability);

        const grid = document.getElementById("weather-grid");
        grid.innerHTML = ""; // Clear old data

        data.locations.forEach(loc => {
          const div = document.createElement("div");
          div.className = "card risk-" + loc.risk.toLowerCase();
          div.innerHTML = `
            <h3>${loc.place}</h3>
            <p><strong>${loc.temp}°C</strong> | ${loc.description}</p>
            <p>Feels like: ${loc.feels_like}°C</p>
            <p>Humidity: ${loc.humidity}% | Wind: ${loc.wind_speed} m/s | Clouds: ${loc.clouds}%</p>
            <p>Rain: ${loc.rain_probability}% (${loc.risk})</p>
          `;
          grid.appendChild(div);
        });
      } catch (err) {
        document.getElementById("weather-grid").textContent = "Failed to load weather data.";
        console.error(err);
      }
    }

    loadWeather();
  </script>
</body>
</html>
